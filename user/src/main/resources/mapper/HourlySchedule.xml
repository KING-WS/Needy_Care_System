<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.sm.app.repository.HourlyScheduleRepository">

    <!-- HourlySchedule CRUD -->
    <select id="selectHourlySchedulesBySchedId" resultType="edu.sm.app.dto.HourlySchedule">
        SELECT 
            hourly_sched_id AS hourlySchedId,
            sched_id AS schedId,
            hourly_sched_start_time AS hourlySchedStartTime,
            hourly_sched_end_time AS hourlySchedEndTime,
            hourly_sched_name AS hourlySchedName,
            hourly_sched_content AS hourlySchedContent,
            is_deleted AS isDeleted,
            hourly_sched_regdate AS hourlySchedRegdate,
            hourly_sched_update AS hourlySchedUpdate
        FROM Hourly_Schedule
        WHERE sched_id = #{schedId} AND is_deleted = 'N'
        ORDER BY hourly_sched_start_time
    </select>

    <select id="selectHourlyScheduleById" resultType="edu.sm.app.dto.HourlySchedule">
        SELECT 
            hourly_sched_id AS hourlySchedId,
            sched_id AS schedId,
            hourly_sched_start_time AS hourlySchedStartTime,
            hourly_sched_end_time AS hourlySchedEndTime,
            hourly_sched_name AS hourlySchedName,
            hourly_sched_content AS hourlySchedContent,
            is_deleted AS isDeleted,
            hourly_sched_regdate AS hourlySchedRegdate,
            hourly_sched_update AS hourlySchedUpdate
        FROM Hourly_Schedule
        WHERE hourly_sched_id = #{hourlySchedId} AND is_deleted = 'N'
    </select>

    <insert id="insertHourlySchedule" useGeneratedKeys="true" keyProperty="hourlySchedId">
        INSERT INTO Hourly_Schedule (sched_id, hourly_sched_start_time, hourly_sched_end_time,
                                     hourly_sched_name, hourly_sched_content, is_deleted,
                                     hourly_sched_regdate, hourly_sched_update)
        VALUES (#{schedId}, #{hourlySchedStartTime}, #{hourlySchedEndTime},
                #{hourlySchedName}, #{hourlySchedContent}, 'N', NOW(), NOW())
    </insert>

    <update id="updateHourlySchedule">
        UPDATE Hourly_Schedule
        SET hourly_sched_start_time = #{hourlySchedStartTime},
            hourly_sched_end_time = #{hourlySchedEndTime},
            hourly_sched_name = #{hourlySchedName},
            hourly_sched_content = #{hourlySchedContent},
            hourly_sched_update = CURRENT_TIMESTAMP
        WHERE hourly_sched_id = #{hourlySchedId}
    </update>

    <update id="deleteHourlySchedule">
        UPDATE Hourly_Schedule
        SET is_deleted = 'Y',
            hourly_sched_update = CURRENT_TIMESTAMP
        WHERE hourly_sched_id = #{hourlySchedId}
    </update>

    <update id="deleteHourlySchedulesBySchedId">
        UPDATE Hourly_Schedule
        SET is_deleted = 'Y',
            hourly_sched_update = CURRENT_TIMESTAMP
        WHERE sched_id = #{schedId}
    </update>

</mapper>