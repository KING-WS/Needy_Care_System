<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.sm.app.repository.RecipientRepository">

    <!-- custId로 돌봄 대상자 목록 조회 (삭제되지 않은 것만) -->
    <select id="selectRecipientsByCustId" resultType="edu.sm.app.dto.Recipient">
        SELECT
            rec_id AS recId,
            rec_type_code AS recTypeCode,
            cust_id AS custId,
            rec_name AS recName,
            rec_birthday AS recBirthday,
            rec_gender AS recGender,
            rec_kiosk_code AS recKioskCode,
            rec_address AS recAddress,
            rec_photo_url AS recPhotoUrl,
            rec_med_history AS recMedHistory,
            rec_allergies AS recAllergies,
            rec_spec_notes AS recSpecNotes,
            is_deleted AS isDeleted,
            rec_regdate AS recRegdate,
            rec_update AS recUpdate,
            rec_health_needs AS recHealthNeeds
        FROM Care_Recipient
        WHERE cust_id = #{custId}
          AND is_deleted = 'N'
        ORDER BY rec_regdate DESC
    </select>

    <!-- recId로 특정 돌봄 대상자 조회 -->
    <select id="selectRecipientById" resultType="edu.sm.app.dto.Recipient">
        SELECT
            rec_id AS recId,
            rec_type_code AS recTypeCode,
            cust_id AS custId,
            rec_name AS recName,
            rec_birthday AS recBirthday,
            rec_gender AS recGender,
            rec_kiosk_code AS recKioskCode,
            rec_address AS recAddress,
            rec_photo_url AS recPhotoUrl,
            rec_med_history AS recMedHistory,
            rec_allergies AS recAllergies,
            rec_spec_notes AS recSpecNotes,
            is_deleted AS isDeleted,
            rec_regdate AS recRegdate,
            rec_update AS recUpdate,
            rec_health_needs AS recHealthNeeds
        FROM Care_Recipient
        WHERE rec_id = #{recId}
          AND is_deleted = 'N'
    </select>

</mapper>